from layers import EmbaeddableModel,LinearLayer
from cpp import cpp_code,write_dep
import torch


if __name__=="__main__":
    model=EmbaeddableModel(torch.float32)
    model.add_layer(LinearLayer(1024,64,dtype=torch.float32))
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#1
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#2
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#3
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#4
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#5
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#6
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#7
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#8
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#9
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#10
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#11
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#12
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#13
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#14
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#15
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#16
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#17
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#18
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#19
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#20
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#21
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#22
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#23
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#24
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#25
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#1
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#2
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#3
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#4
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#5
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#6
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#7
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#8
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#9
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#10
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#11
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#12
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#13
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#14
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#15
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#16
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#17
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#18
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#19
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#20
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#21
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#22
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#23
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#24
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#25
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#1
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#2
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#3
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#4
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#5
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#6
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#7
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#8
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#9
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#10
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#11
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#12
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#13
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#14
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#15
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#16
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#17
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#18
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#19
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#20
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#21
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#22
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#23
    model.add_layer(LinearLayer(64,64,dtype=torch.float32))#24
    model.add_layer(LinearLayer(64,16,dtype=torch.float32))#25
    model.add_layer(LinearLayer(16,1,dtype=torch.float32))
    write_dep()
    with open("out/code.cpp","w",encoding="utf-8") as f:
        print(cpp_code(model.list),file=f)